<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebShark</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .upload-section {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .upload-btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .upload-btn:hover {
            background-color: #2980b9;
        }
        
        #fileInput {
            display: none;
        }
        
        .file-info {
            margin-top: 10px;
            color: #666;
        }
        
        .results-section {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .results-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background-color: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-size: 16px;
            color: #666;
        }
        
        .tab-btn.active {
            border-bottom-color: #3498db;
            color: #3498db;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* 数据包详情表格自动换行样式 */
        #packetDetails td {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        /* 表格容器样式 */
        .table-container {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }
        
        /* 筛选图标样式 */
        .filter-icon {
            display: inline-block;
            margin-left: 5px;
            font-size: 10px;
            color: #ccc;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        
        .filter-icon:hover {
            color: #3498db;
        }
        
        .filter-icon.active {
            color: #3498db;
        }
        
        /* 筛选后的表头样式 */
        th.filtered {
            background-color: #e3f2fd !important;
            color: #1565c0 !important;
        }
        
        /* 筛选下拉菜单样式 */
        .filter-dropdown {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            min-width: 200px;
            max-height: 300px;
        }
        
        /* 筛选下拉菜单底部样式 */
        .filter-dropdown-footer {
            position: sticky;
            bottom: 0;
            background-color: #fafafa;
            border-top: 1px solid #eee;
            padding: 8px 12px;
        }
        
        /* 全局表格样式 */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        td {
            padding: 8px;
            border: 1px solid #ddd;
            font-family: Arial, sans-serif;
        }
        
        /* 隐藏IP端口统计的标题和翻页 */
        #ipPortStats h3 {
            display: none;
        }
        
        #ipPortStatsContent h4,
        #ipPortStatsContent #pagination {
            display: none;
        }
        
        /* 隐藏连接频率统计的标题和翻页 */
        #connectionStats h3 {
            display: none;
        }
        
        #connectionStatsContent h4,
        #connectionStatsContent #pagination {
            display: none;
        }
        
        /* 隐藏所有分页控件中的"每页显示"选择框 */
        #ipPortStatsContent #pagination div:first-child,
        #connectionStatsContent #pagination div:first-child {
            display: none;
        }
        
        .filter-dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .filter-dropdown-item:hover {
            background-color: #f5f5f5;
        }
        
        .filter-dropdown-item.selected {
            background-color: #e3f2fd;
            color: #2196f3;
        }
        
        .filter-dropdown-header {
            padding: 8px 12px;
            font-weight: bold;
            border-bottom: 1px solid #eee;
            background-color: #fafafa;
        }
        
        .filter-dropdown-footer {
            padding: 8px 12px;
            border-top: 1px solid #eee;
            background-color: #fafafa;
            text-align: right;
        }
        
        /* 安全检测状态样式 */
        .security-safe {
            color: #27ae60;
            background-color: #e8f5e8;
        }
        
        .security-danger {
            color: #e74c3c;
            background-color: #ffebee;
        }
        
        .filter-btn {
            padding: 4px 8px;
            margin-left: 5px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .filter-btn:hover {
            background-color: #2980b9;
        }
        
        .filter-btn.clear {
            background-color: #95a5a6;
        }
        
        .filter-btn.clear:hover {
            background-color: #7f8c8d;
        }
        
        .packets-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: auto;
            min-width: 100%;
            white-space: nowrap;
        }
        
        .packets-table th,
        .packets-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 80px;
        }
        
        .packets-table th {
            background-color: #343a40;
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 0.5px;
            position: relative;
            user-select: none;
        }
        
        /* 拖拽指示器 - 增强拖拽区域检测 */
        .packets-table th {
            padding-right: 10px;
            position: relative;
        }
        
        .packets-table th::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 10px;
            height: 100%;
            background-color: transparent;
            cursor: col-resize;
            z-index: 1000;
        }
        
        .packets-table th:hover::after {
            background-color: #3498db;
            opacity: 0.5;
        }
        
        /* 确保拖拽时鼠标样式正确 */
        .packets-table th:hover {
            cursor: pointer;
        }
        
        /* 排序时鼠标样式 */
        .packets-table th:not(:hover) {
            cursor: pointer;
        }
        
        /* 确保表格内的文本不会换行 */
        .packets-table td {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .packets-table tr {
            background-color: white;
            transition: all 0.2s ease;
        }
        
        .packets-table tr:hover {
            background-color: #f8f9fa;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .packets-table tr.selected {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        
        /* 流列表样式 */
        #flows {
            padding: 20px;
        }
        
        .flows-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }
        
        .flow-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .flow-section:hover {
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .flow-section h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .flow-section h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: #3498db;
            border-radius: 2px;
        }
        
        /* 为流列表和HTTP请求URL列表的滚动容器添加样式 */
        .flow-section div[style*="max-height"] {
            position: relative;
            overflow-y: auto;
        }
        
        /* 确保表格宽度为100% */
        .flow-section table.packets-table {
            width: 100%;
        }
        
        /* 固定表头样式 */
        .flow-section div[style*="max-height"] .packets-table thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        /* 数据包列表的表头固定 */
        #packets div[style*="max-height"] .packets-table thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        /* 确保表头背景不透明 */
        .packets-table th {
            background-color: #343a40 !important;
            color: white !important;
        }
        
        /* 搜索框样式优化 */
        .search-section {
            margin-bottom: 20px;
        }
        
        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .search-btn {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .search-btn:hover {
            background-color: #2980b9;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        .clear-btn {
            padding: 10px 20px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .clear-btn:hover {
            background-color: #5a6268;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(108, 117, 125, 0.3);
        }
        
        /* 流对话样式 */
        #flowConversation {
            background: #ffffff;
            border-radius: 12px;
            padding: 25px;
            max-height: 450px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        /* 对话消息样式 */
        .conversation-message {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 12px;
            max-width: 85%;
            word-wrap: break-word;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .conversation-message.sent {
            background: #e3f2fd;
            color: #1565c0;
            margin-left: auto;
            border-bottom-right-radius: 2px;
        }
        
        .conversation-message.received {
            background: #e8f5e8;
            color: #2e7d32;
            margin-right: auto;
            border-bottom-left-radius: 2px;
        }
        
        .conversation-message:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }
        
        .conversation-header {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            opacity: 0.8;
        }
        
        .conversation-content {
            font-size: 13px;
            line-height: 1.5;
        }
        
        /* 滚动条样式 */
        #flowConversation::-webkit-scrollbar {
            width: 10px;
        }
        
        #flowConversation::-webkit-scrollbar-track {
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        #flowConversation::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 5px;
            transition: background 0.2s ease;
        }
        
        #flowConversation::-webkit-scrollbar-thumb:hover {
            background: #9e9e9e;
        }
        
        /* 开关按钮样式 */
        .toggle-slider {
            background-color: #ccc !important;
        }
        
        .toggle-switch input:checked + .toggle-slider {
            background-color: #3498db !important;
        }
        
        .toggle-switch input:checked + .toggle-slider + .toggle-handle {
            transform: translateX(26px);
        }
        
        /* 添加一个简单的点击效果 */
        .toggle-switch:active .toggle-handle {
            width: 30px;
        }
        
        .toggle-switch input:checked:active + .toggle-slider + .toggle-handle {
            transform: translateX(22px);
        }
        
        /* 流信息卡片样式 */
        .flow-info-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        /* 复制按钮样式 */
        .copy-btn {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .copy-btn:hover {
            background-color: #2980b9;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        
        /* 复制通知样式 */
        #copyNotification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10000;
            font-size: 14px;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: translateY(-20px);
        }
        
        /* 结果计数样式 */
        .result-count, .flow-result-count {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        /* 分隔线样式 */
        .divider {
            height: 1px;
            background: #e9ecef;
            margin: 20px 0;
        }
        
        .packet-details {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .packet-hex {
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin-top: 10px;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 右上角菜单 -->
        <div style="position: absolute; top: 20px; right: 20px; z-index: 1000;">
            <div style="display: flex; gap: 10px;">
                <button onclick="openModal('aboutModal')" style="padding: 8px 16px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">关于</button>
                <button onclick="openModal('helpModal')" style="padding: 8px 16px; background-color: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">帮助</button>
            </div>
        </div>
        <h1>WebShark</h1>
        
        <div class="upload-section">
            <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                选择PCAP/PCAPNG文件
            </button>
            <input type="file" id="fileInput" accept=".pcapng,.pcap" onchange="handleFileUpload(event)">
            <div class="file-info" id="fileInfo">未选择文件</div>
        </div>
        
        <div class="results-section">
            <div class="results-tabs">
                <button class="tab-btn" onclick="switchTab('overview')">概览</button>
                <button class="tab-btn" onclick="switchTab('packets')">数据包列表</button>
                <button class="tab-btn" onclick="switchTab('flows')">流列表</button>
                <button class="tab-btn" onclick="switchTab('appRequests')">应用层请求</button>
                <button class="tab-btn" onclick="switchTab('details')">数据包详情</button>
                <button class="tab-btn" onclick="switchTab('ipPortStats')">IP端口统计</button>
                <button class="tab-btn" onclick="switchTab('connectionStats')">连接频率统计</button>
                <button class="tab-btn" onclick="switchTab('settings')">设置</button>
            </div>
            
            <!-- 设置页面 -->
            <div id="settings" class="tab-content" style="padding: 20px;">
                <h2 style="margin-bottom: 20px; color: #333;">设置</h2>
                
                <!-- 关键字管理 -->
                <div style="margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                    <h3 style="margin: 0 0 15px 0; font-size: 18px; color: #555;">关键字管理</h3>
                    
                    <!-- 关键字匹配开关 -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 15px; background-color: white; border-radius: 8px; border: 1px solid #eee;">
                        <label for="keywordMatchToggle" style="font-size: 16px; font-weight: 500; color: #555; flex: 1;">启用关键字匹配</label>
                        <label class="toggle-switch" style="position: relative; display: inline-block; width: 60px; height: 34px; cursor: pointer;">
                            <input type="checkbox" id="keywordMatchToggle" style="display: none;">
                            <span class="toggle-slider" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; border-radius: 34px; transition: all 0.4s ease;"></span>
                            <span class="toggle-handle" style="position: absolute; top: 4px; left: 4px; width: 26px; height: 26px; background-color: white; border-radius: 50%; transition: all 0.4s ease;"></span>
                        </label>
                    </div>
                    
                    <!-- 添加关键字 -->
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <input type="text" id="newKeyword" placeholder="添加新关键字" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; text-align: left; direction: ltr; unicode-bidi: bidi-override;" dir="ltr">
                        <button onclick="addKeyword()" style="padding: 12px 20px; background-color: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 500;">添加</button>
                    </div>
                    
                    <!-- 关键字列表 -->
                    <div id="keywordList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; padding: 10px; background-color: white;">
                        <!-- 关键字列表将通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <!-- 保存和还原设置按钮 -->
                <div style="display: flex; justify-content: flex-end; gap: 10px;">
                    <button onclick="restoreDefaultKeywords()" style="padding: 12px 24px; background-color: #f39c12; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 500;">还原默认关键字</button>
                    <button onclick="saveSettings()" style="padding: 12px 24px; background-color: #3498db; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 500;">保存设置</button>
                </div>
            </div>
            
            <!-- 分页控件 -->
            <div id="pagination" style="margin: 10px 0; display: none; justify-content: space-between; align-items: center; position: sticky; top: 0; background-color: white; z-index: 200; padding: 10px 0; border-bottom: 1px solid #eee;">
                <div>
                    <span>每页显示：</span>
                    <select id="pageSize" onchange="changePageSize()" style="padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="10">10条</option>
                        <option value="100" selected>100条</option>
                        <option value="500">500条</option>
                        <option value="5000">5000条</option>
                        <option value="all">全部</option>
                    </select>
                </div>
                <div id="pageInfo" style="font-size: 14px; color: #666;"></div>
                <div>
                    <button id="prevPage" onclick="prevPage()" disabled style="padding: 5px 10px; margin-right: 5px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">上一页</button>
                    <button id="nextPage" onclick="nextPage()" disabled style="padding: 5px 10px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">下一页</button>
                </div>
            </div>
            
            <div id="overview" class="tab-content active">
                <div class="loading" id="loading">请选择PCAPNG文件进行分析</div>
                <div id="stats" style="display: none;">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="packetCount">0</div>
                            <div class="stat-label">数据包数量</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="fileSize">0</div>
                            <div class="stat-label">文件大小</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="duration">0</div>
                            <div class="stat-label">捕获时长</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avgPacketSize">0</div>
                            <div class="stat-label">平均包大小</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalBytes">0 bytes</div>
                            <div class="stat-label">总流量</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="sendBytes">0 bytes</div>
                            <div class="stat-label">发送流量</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="receiveBytes">0 bytes</div>
                            <div class="stat-label">接收流量</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avgBytesPerSec">0 bytes/s</div>
                            <div class="stat-label">平均速率</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="deviceInfo">N/A</div>
                            <div class="stat-label">设备信息</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="srcAddressCount">0</div>
                            <div class="stat-label">源地址数量</div>
                        </div>
                    </div>
                    
                    <!-- 协议使用统计 -->
                    <div style="margin-top: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                        <h3 style="margin-bottom: 15px; color: #333;">协议使用统计</h3>
                        <div id="appProtocolStats" style="display: flex; flex-wrap: wrap; gap: 15px;"></div>
                    </div>
                    
                    <!-- 分析时间统计 -->
                    <div style="margin-top: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                        <h3 style="margin-bottom: 15px; color: #333;">分析时间统计</h3>
                        <div id="timingStats" style="display: flex; flex-direction: column; gap: 15px;">
                            <!-- 总分析时间 -->
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background-color: #fff; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                <span style="font-weight: bold;">总分析时间:</span>
                                <span id="totalAnalysisTime">0.00 ms</span>
                            </div>
                            
                            <!-- 各阶段时间统计表格 -->
                            <table style="width: 100%; border-collapse: collapse; background-color: #fff; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                <thead style="background-color: #3498db; color: white;">
                                    <tr>
                                        <th style="padding: 12px; text-align: left;">分析阶段</th>
                                        <th style="padding: 12px; text-align: right;">耗时 (ms)</th>
                                        <th style="padding: 12px; text-align: right;">占比</th>
                                    </tr>
                                </thead>
                                <tbody id="timingDetails">
                                    <!-- 动态填充的计时数据行 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    

                    

                </div>
            </div>
            
            <div id="packets" class="tab-content">
                <!-- 简单搜索和导出按钮 -->
                <div class="search-section">
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <input type="text" id="searchInput" placeholder="搜索：IP、端口、协议、时间等" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: left; direction: ltr; unicode-bidi: bidi-override;" dir="ltr">
                        <select id="filterType" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="all">全部字段</option>
                            <option value="uniqueId">唯一ID</option>
                            <option value="number">序号</option>
                            <option value="time">时间</option>
                            <option value="srcIp">源地址</option>
                            <option value="srcPort">源端口</option>
                            <option value="dstIp">目的地址</option>
                            <option value="dstPort">目标端口</option>
                            <option value="protocolChain">协议</option>
                            <option value="streamId">流ID</option>
                            <option value="packetLen">长度</option>
                            <option value="functionDesc">功能介绍</option>
                            <option value="info">信息</option>
                        </select>
                        <button onclick="filterPackets()" style="padding: 8px 15px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">搜索</button>
                        <button onclick="exportPacketsToXLSX()" style="padding: 8px 15px; background-color: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer;">导出XLSX</button>
                    </div>
                    
                    <!-- 多条件高级筛选 -->
                    <div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; position: relative;">
                        <h4 style="margin-bottom: 15px; color: #333;">高级筛选</h4>
                        <div id="filterConditions" style="display: flex; flex-direction: column; gap: 10px;">
                            <!-- 第一个筛选条件 -->
                            <div class="filter-row" style="display: flex; gap: 10px; align-items: center;">
                                <select class="filter-field" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="uniqueId">唯一ID</option>
                                    <option value="srcIp">源地址</option>
                                    <option value="srcPort">源端口</option>
                                    <option value="dstIp">目的地址</option>
                                    <option value="dstPort">目标端口</option>
                                    <option value="protocolChain">协议</option>
                                    <option value="streamId">流ID</option>
                                    <option value="packetLen">长度</option>
                                    <option value="functionDesc">功能介绍</option>
                                    <option value="info">信息</option>
                                </select>
                                <select class="filter-operator" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="contains">包含</option>
                                    <option value="equals">等于</option>
                                    <option value="startsWith">开始于</option>
                                    <option value="endsWith">结束于</option>
                                    <option value="notContains">不包含</option>
                                    <option value="notEquals">不等于</option>
                                    <option value="greaterThan">大于</option>
                                    <option value="lessThan">小于</option>
                                </select>
                                <input type="text" class="filter-value" placeholder="筛选值" style="flex: 1; padding: 6px; border: 1px solid #ddd; border-radius: 4px; text-align: left; direction: ltr; unicode-bidi: bidi-override;" dir="ltr">
                                <select class="filter-logic" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="AND">AND</option>
                                    <option value="OR">OR</option>
                                </select>
                                <button class="remove-filter" onclick="removeFilter(this)" style="padding: 6px 12px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;">删除</button>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                            <div>
                                <button id="addFilter" onclick="addFilter()" style="padding: 8px 15px; background-color: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer;">添加条件</button>
                                <button id="applyAdvancedFilter" onclick="applyAdvancedFilter()" style="margin-left: 10px; padding: 8px 15px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">应用筛选</button>
                            </div>
                            <button onclick="clearAllFilters()" style="padding: 8px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3); transition: all 0.2s ease;">清除筛选</button>
                        </div>
                    </div>
                </div>
                <div class="table-container" style="max-height: 600px; overflow: auto;">
                    <table class="packets-table" id="packetsTable">
                        <thead>
                            <tr>
                                <th>操作</th>
                                <th onclick="sortPackets('uniqueId')">唯一ID</th>
                                <th onclick="sortPackets('index')">序号</th>
                                <th onclick="sortPackets('timestamp')">时间</th>
                                <th onclick="sortPackets('srcIp')">源地址</th>
                                <th onclick="sortPackets('srcPort')">源端口</th>
                                <th onclick="sortPackets('dstIp')">目的地址</th>
                                <th onclick="sortPackets('dstPort')">目标端口</th>
                                <th onclick="sortPackets('protocolChain')">协议</th>
                                <th onclick="sortPackets('streamId')">流ID</th>
                                <th onclick="sortPackets('packetLen')">长度</th>
                                <th>功能介绍</th>
                                <th onclick="sortPackets('info')">信息</th>
                                <th>关键字匹配</th>
                            </tr>
                        </thead>
                        <tbody id="packetsBody">
                            <tr>
                                <td colspan="13" style="text-align: center; color: #666;">请选择PCAP/PCAPNG文件进行分析</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="flows" class="tab-content">
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <input type="text" id="flowSearchInput" placeholder="搜索流：流ID、IP、端口、协议等" class="search-input" style="text-align: left; direction: ltr; unicode-bidi: bidi-override;" dir="ltr">
                        <select id="flowFilterType" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="all">全部字段</option>
                            <option value="streamId">流ID</option>
                            <option value="srcIp">源地址</option>
                            <option value="srcPort">源端口</option>
                            <option value="dstIp">目的地址</option>
                            <option value="dstPort">目标端口</option>
                            <option value="packetCount">数据包数量</option>
                            <option value="protocol">协议</option>
                            <option value="conversation">流对话</option>
                        </select>
                        <button onclick="filterFlows()" class="search-btn">搜索</button>
                    </div>
                    
                    <!-- 多条件高级筛选 -->
                    <div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
                        <h4 style="margin-bottom: 15px; color: #333;">高级筛选</h4>
                        <div id="flowFilterConditions" style="display: flex; flex-direction: column; gap: 10px;">
                            <!-- 第一个筛选条件 -->
                            <div class="flow-filter-row" style="display: flex; gap: 10px; align-items: center;">
                                <select class="filter-field" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="streamId">流ID</option>
                                    <option value="srcIp">源IP</option>
                                    <option value="srcPort">源端口</option>
                                    <option value="dstIp">目标IP</option>
                                    <option value="dstPort">目标端口</option>
                                    <option value="packetCount">数据包数量</option>
                                    <option value="protocol">协议</option>
                                    <option value="conversation">流对话</option>
                                </select>
                                <select class="filter-operator" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="contains">包含</option>
                                    <option value="equals">等于</option>
                                    <option value="startsWith">开始于</option>
                                    <option value="endsWith">结束于</option>
                                    <option value="notContains">不包含</option>
                                    <option value="notEquals">不等于</option>
                                    <option value="greaterThan">大于</option>
                                    <option value="lessThan">小于</option>
                                </select>
                                <input type="text" class="filter-value" placeholder="筛选值" style="flex: 1; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" dir="ltr">
                                <select class="filter-logic" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="AND">AND</option>
                                    <option value="OR">OR</option>
                                </select>
                                <button class="remove-filter" onclick="removeFilter(this, 'flow')" style="padding: 6px 12px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;">删除</button>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                            <div>
                                <button id="addFlowFilter" onclick="addFilter('flow')" style="padding: 8px 15px; background-color: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer;">添加条件</button>
                                <button id="applyFlowAdvancedFilter" onclick="applyAdvancedFilter('flow')" style="margin-left: 10px; padding: 8px 15px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">应用筛选</button>
                            </div>
                            <button onclick="clearAllFilters()" style="padding: 10px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: bold; box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3); transition: all 0.2s ease;">清除筛选</button>
                        </div>
                    </div>
                </div>
                <div style="display: flex; flex-direction: column; gap: 25px;">                    <div class="flow-section">
                        <h3>流列表</h3>
                        <div class="table-container" style="max-height: 300px; overflow: auto;">
                            <table class="packets-table" id="flowsTable">
                                <thead>
                                    <tr>
                                        <th onclick="sortFlows('streamId')">流ID</th>
                                        <th onclick="sortFlows('src')">源IP:端口</th>
                                        <th onclick="sortFlows('dst')">目标IP:端口</th>
                                        <th onclick="sortFlows('packetCount')">数据包数量</th>
                                        <th onclick="sortFlows('totalLength')">长度</th>
                                        <th onclick="sortFlows('protocol')">协议</th>
                                        <th>协议统计</th>
                                    </tr>
                                </thead>
                                <tbody id="flowsBody">
                                    <tr>
                                        <td colspan="7" style="text-align: center; color: #666;">请选择PCAP/PCAPNG文件进行分析</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="flow-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <h3 style="margin: 0;">流对话</h3>
                                <span id="currentStreamId" style="font-size: 12px; color: #666; font-weight: 500;"></span>
                                <button onclick="showPrevFlow()" id="prevFlowBtn" style="padding: 4px 8px; background-color: #64748b; color: white; border: none; border-radius: 4px; font-size: 11px; cursor: pointer; display: none;">上一条</button>
                                <button onclick="showNextFlow()" id="nextFlowBtn" style="padding: 4px 8px; background-color: #64748b; color: white; border: none; border-radius: 4px; font-size: 11px; cursor: pointer; display: none;">下一条</button>
                            </div>
                        </div>
                        <div id="flowConversation" style="max-height: 400px;">
                            <p style="text-align: center; color: #666;">请从流列表中选择一个流查看对话</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 应用层请求标签页 -->
            <div id="appRequests" class="tab-content">
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <input type="text" id="appRequestSearch" placeholder="搜索应用层请求" class="search-input" style="text-align: left; direction: ltr; unicode-bidi: bidi-override;" dir="ltr">
                        <select id="appRequestFilterType" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="all">全部字段</option>
                            <option value="method">请求方法</option>
                            <option value="path">URL路径</option>
                            <option value="version">协议版本</option>
                            <option value="srcAddr">源IP:端口</option>
                            <option value="dstAddr">目标IP:端口</option>
                            <option value="responseStatus">响应状态</option>
                            <option value="responseSize">响应大小</option>
                            <option value="host">Host</option>
                            <option value="userAgent">User-Agent</option>
                            <option value="accept">Accept</option>
                            <option value="acceptLanguage">Accept-Language</option>
                            <option value="cookie">Cookie</option>
                            <option value="contentType">Content-Type</option>
                            <option value="responseContentType">响应内容类型</option>
                            <option value="server">服务器</option>
                            <option value="responseTime">响应时间</option>
                            <option value="requestDetails">请求详情</option>
                            <option value="responseDetails">响应详情</option>
                        </select>
                        <button onclick="searchAppRequests()" class="search-btn">搜索</button>
                        <button onclick="exportAppRequestsToXLSX()" style="padding: 10px 20px; background-color: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px;">导出XLSX</button>
                    </div>
                    
                    <!-- 多条件高级筛选 -->
                    <div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
                        <h4 style="margin-bottom: 15px; color: #333;">高级筛选</h4>
                        <div id="appRequestFilterConditions" style="display: flex; flex-direction: column; gap: 10px;">
                            <!-- 第一个筛选条件 -->
                            <div class="appRequest-filter-row" style="display: flex; gap: 10px; align-items: center;">
                                <select class="filter-field" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="method">请求方法</option>
                                    <option value="path">URL路径</option>
                                    <option value="version">协议版本</option>
                                    <option value="srcAddr">源IP:端口</option>
                                    <option value="dstAddr">目标IP:端口</option>
                                    <option value="responseStatus">响应状态</option>
                                    <option value="responseSize">响应大小</option>
                                    <option value="host">Host</option>
                                    <option value="userAgent">User-Agent</option>
                                    <option value="accept">Accept</option>
                                    <option value="acceptLanguage">Accept-Language</option>
                                    <option value="cookie">Cookie</option>
                                    <option value="contentType">Content-Type</option>
                                    <option value="responseContentType">响应内容类型</option>
                                    <option value="server">服务器</option>
                                    <option value="responseTime">响应时间</option>
                                    <option value="requestDetails">请求详情</option>
                                    <option value="responseDetails">响应详情</option>
                                </select>
                                <select class="filter-operator" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="contains">包含</option>
                                    <option value="equals">等于</option>
                                    <option value="startsWith">开始于</option>
                                    <option value="endsWith">结束于</option>
                                    <option value="notContains">不包含</option>
                                    <option value="notEquals">不等于</option>
                                    <option value="greaterThan">大于</option>
                                    <option value="lessThan">小于</option>
                                </select>
                                <input type="text" class="filter-value" placeholder="筛选值" style="flex: 1; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" dir="ltr">
                                <select class="filter-logic" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="AND">AND</option>
                                    <option value="OR">OR</option>
                                </select>
                                <button class="remove-filter" onclick="removeFilter(this, 'appRequest')" style="padding: 6px 12px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;">删除</button>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                            <div>
                                <button id="addAppRequestFilter" onclick="addFilter('appRequest')" style="padding: 8px 15px; background-color: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer;">添加条件</button>
                                <button id="applyAppRequestAdvancedFilter" onclick="applyAdvancedFilter('appRequest')" style="margin-left: 10px; padding: 8px 15px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">应用筛选</button>
                            </div>
                            <button onclick="clearAllFilters()" style="padding: 10px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: bold; box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3); transition: all 0.2s ease;">清除筛选</button>
                        </div>
                    </div>
                    <div class="flow-result-count" id="appRequestCount" style="margin-bottom: 15px; color: #666;">请选择PCAPNG文件进行分析</div>
                </div>
                <div class="flow-section">
                        <h3>应用层请求列表</h3>
                        <div class="table-container" style="max-height: 500px; overflow: auto;">
                            <table class="packets-table" id="appRequestsTable">
                            <thead>
                                <tr>
                            <th onclick="sortAppRequests('index')">序号</th>
                            <th onclick="sortAppRequests('method')">请求方法</th>
                            <th onclick="sortAppRequests('path')">URL路径</th>
                            <!-- 隐藏协议版本列 -->
                            <th onclick="sortAppRequests('version')" style="display: none;">协议版本</th>
                            <th onclick="sortAppRequests('srcAddr')">源IP:端口</th>
                            <th onclick="sortAppRequests('dstAddr')">目标IP:端口</th>
                            <th onclick="sortAppRequests('responseStatus')">响应状态</th>
                            <th onclick="sortAppRequests('responseSize')">响应大小</th>
                            <th onclick="sortAppRequests('host')">Host</th>
                            <th onclick="sortAppRequests('userAgent')">User-Agent</th>
                            <th onclick="sortAppRequests('accept')">Accept</th>
                            <th onclick="sortAppRequests('acceptLanguage')">Accept-Language</th>
                            <th onclick="sortAppRequests('cookie')">Cookie</th>
                            <th onclick="sortAppRequests('contentType')">Content-Type</th>
                            <th onclick="sortAppRequests('responseContentType')">响应内容类型</th>
                            <th onclick="sortAppRequests('server')">服务器</th>
                            <th onclick="sortAppRequests('responseTime')">响应时间</th>
                            <th>请求体内容</th>
                            <th>响应体内容</th>
                            <th>安全状态</th>
                            <th>操作</th>
                        </tr>
                            </thead>
                            <tbody id="appRequestsBody">
                                <tr>
                                    <td colspan="20" style="text-align: center; color: #666;">请选择PCAP/PCAPNG文件进行分析</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div id="details" class="tab-content">
                <div id="packetDetails">
                    <p style="text-align: center; color: #666;">请从列表中选择一个数据包查看详情</p>
                </div>
            </div>
            
            <div id="ipPortStats" class="tab-content">
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: #333;">IP端口使用统计</h3>
                    <div id="ipPortStatsContainer" style="margin-bottom: 20px;">
                        <div class="loading" id="ipPortStatsLoading">请选择PCAP/PCAPNG文件进行分析</div>
                        <div id="ipPortStatsContent" style="display: none;">
                            <!-- IP端口统计表将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="connectionStats" class="tab-content">
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: #333;">IP+端口连接频率统计</h3>
                    <div id="connectionStatsContainer" style="margin-bottom: 20px;">
                        <div class="loading" id="connectionStatsLoading">请选择PCAP/PCAPNG文件进行分析</div>
                        <div id="connectionStatsContent" style="display: none;">
                            <!-- IP+端口连接频率跟踪表将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="pcapng-parser.js"></script>
    <script src="security-detector.js"></script>
    <script src="xlsx.full.min.js"></script>
    <script src="app.js"></script>
    
    <!-- CSDN博客链接 -->
    <div style="position: fixed; bottom: 10px; right: 10px; z-index: 1000; opacity: 0.6;">
        <a href="https://blog.csdn.net/qq_37400312" target="_blank" style="text-decoration: none; color: #333; font-size: 12px;">
            CSDN博客
        </a>
    </div>
    
    <!-- 自定义提示框 -->
    <div id="customAlert" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px); background: #3498db; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 10001; font-size: 14px; font-weight: 500; opacity: 0; visibility: hidden; transition: all 0.3s ease; text-align: center; max-width: 400px; width: 90%;">
        <div id="customAlertContent"></div>
    </div>

    <!-- 关于模态框 -->
    <div id="aboutModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 10000; display: none; justify-content: center; align-items: center;">
        <div style="background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #333;">关于</h2>
                <button onclick="closeModal('aboutModal')" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">&times;</button>
            </div>
            <div style="line-height: 1.6; color: #555;">
                <p style="margin-bottom: 15px;"><strong>工具目的：</strong>本工具设计用于在合法、授权的实验环境中，模拟、研究与学习网络安全防御原理。</p>
                <p style="margin-bottom: 15px;"><strong>开发者：</strong>EchoOfCloud</p>
                <p style="margin-bottom: 15px;"><strong>技术博客：</strong><a href="https://blog.csdn.net/qq_37400312" target="_blank" style="color: #3498db; text-decoration: none;">https://blog.csdn.net/qq_37400312</a></p>
                <p style="margin-bottom: 15px;"><strong>GitHub：</strong><a href="https://github.com/EchoOfCloud" target="_blank" style="color: #3498db; text-decoration: none;">https://github.com/EchoOfCloud</a></p>
            </div>
        </div>
    </div>

    <!-- 帮助模态框 -->
    <div id="helpModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 10000; display: none; justify-content: center; align-items: center;">
        <div style="background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); max-width: 700px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #333;">帮助</h2>
                <button onclick="closeModal('helpModal')" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">&times;</button>
            </div>
            <div style="line-height: 1.6; color: #555;">
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">1. 软件介绍</h3>
                <p>WebShark是一款功能强大的网络流量分析工具，专为学习和掌握网络原理设计。它可以帮助您深入了解网络通信的各个层面，从物理层到应用层，全面分析网络数据包的结构和内容。</p>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">2. 快速开始</h3>
                <ol style="padding-left: 20px;">
                    <li style="margin-bottom: 10px;"><strong>启动软件：</strong>将WebShark文件夹部署到本地Web服务器，或直接用浏览器打开index.html文件。</li>
                    <li style="margin-bottom: 10px;"><strong>选择文件：</strong>点击页面上方的"选择PCAP/PCAPNG文件"按钮，在文件选择对话框中找到并选择您要分析的网络流量捕获文件。支持PCAP和PCAPNG两种格式。</li>
                    <li style="margin-bottom: 10px;"><strong>等待解析：</strong>文件上传后，系统会自动解析数据包内容。解析速度取决于文件大小，较大的文件可能需要更长时间。</li>
                    <li style="margin-bottom: 10px;"><strong>开始分析：</strong>解析完成后，您可以通过不同的标签页查看各种分析结果，包括概览、数据包列表、流列表等。</li>
                </ol>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">3. 功能详细说明</h3>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.1 概览</h4>
                <p>概览页面提供了捕获文件的总体统计信息，帮助您快速了解网络流量的基本情况：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>基本统计：</strong>显示数据包数量、文件大小、捕获时长、平均包大小、总流量等核心指标。</li>
                    <li style="margin-bottom: 8px;"><strong>流量分布：</strong>展示发送流量和接收流量的比例，以及平均传输速率。</li>
                    <li style="margin-bottom: 8px;"><strong>设备信息：</strong>显示捕获设备的相关信息（如果可用）。</li>
                    <li style="margin-bottom: 8px;"><strong>协议统计：</strong>直观展示各种协议在捕获文件中的使用比例，包括TCP、UDP、HTTP、DNS等。</li>
                    <li style="margin-bottom: 8px;"><strong>分析时间：</strong>显示软件分析文件所花费的时间，以及各阶段的详细耗时。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.2 数据包列表</h4>
                <p>数据包列表展示了捕获文件中的所有数据包，每条记录包含以下信息：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>唯一ID：</strong>每个数据包的唯一标识符。</li>
                    <li style="margin-bottom: 8px;"><strong>序号：</strong>数据包在文件中的顺序编号。</li>
                    <li style="margin-bottom: 8px;"><strong>时间：</strong>数据包捕获的时间戳。</li>
                    <li style="margin-bottom: 8px;"><strong>源地址/端口：</strong>发送方的IP地址和端口号。</li>
                    <li style="margin-bottom: 8px;"><strong>目的地址/端口：</strong>接收方的IP地址和端口号。</li>
                    <li style="margin-bottom: 8px;"><strong>协议：</strong>数据包使用的协议栈，如TCP/HTTP、UDP/DNS等。</li>
                    <li style="margin-bottom: 8px;"><strong>流ID：</strong>数据包所属流的标识符。</li>
                    <li style="margin-bottom: 8px;"><strong>长度：</strong>数据包的总长度（字节）。</li>
                    <li style="margin-bottom: 8px;"><strong>功能介绍：</strong>数据包的简要功能描述。</li>
                    <li style="margin-bottom: 8px;"><strong>信息：</strong>数据包的详细信息，如HTTP方法和URL、DNS查询内容等。</li>
                    <li style="margin-bottom: 8px;"><strong>关键字匹配：</strong>显示数据包是否匹配了预设的关键字规则。</li>
                </ul>
                <p><strong>操作功能：</strong></p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>搜索：</strong>在搜索框中输入关键词，可按IP、端口、协议、时间等字段搜索数据包。</li>
                    <li style="margin-bottom: 8px;"><strong>高级筛选：</strong>使用多条件筛选功能，可通过包含、等于、开始于、结束于等多种条件组合筛选数据包。</li>
                    <li style="margin-bottom: 8px;"><strong>排序：</strong>点击表头可按对应字段排序，再次点击可切换升降序。</li>
                    <li style="margin-bottom: 8px;"><strong>导出：</strong>支持将数据包列表导出为XLSX格式，方便进一步分析和报告生成。</li>
                    <li style="margin-bottom: 8px;"><strong>查看详情：</strong>点击数据包行，可在"数据包详情"标签页查看该数据包的完整信息。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.3 流列表</h4>
                <p>流列表将数据包按流（会话）分组，显示每个流的统计信息和详细对话：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>流列表：</strong>显示所有流的基本信息，包括流ID、源IP:端口、目标IP:端口、数据包数量、总长度、协议等。</li>
                    <li style="margin-bottom: 8px;"><strong>流对话：</strong>选择一个流后，下方会显示该流的详细对话内容，以消息气泡的形式展示发送和接收的数据包，清晰呈现通信过程。</li>
                    <li style="margin-bottom: 8px;"><strong>流搜索：</strong>支持按流ID、IP、端口、协议等字段搜索流。</li>
                    <li style="margin-bottom: 8px;"><strong>流排序：</strong>点击表头可按对应字段对流进行排序。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.4 应用层请求</h4>
                <p>专门用于分析应用层协议的请求和响应，目前主要支持HTTP协议：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>请求列表：</strong>显示所有HTTP请求的详细信息，包括请求方法、URL路径、源地址、目标地址、响应状态、响应大小等。</li>
                    <li style="margin-bottom: 8px;"><strong>请求/响应详情：</strong>展示HTTP请求和响应的完整头信息和正文内容。</li>
                    <li style="margin-bottom: 8px;"><strong>响应状态统计：</strong>直观展示不同HTTP响应状态码的分布情况。</li>
                    <li style="margin-bottom: 8px;"><strong>User-Agent分析：</strong>显示客户端使用的浏览器和操作系统信息。</li>
                    <li style="margin-bottom: 8px;"><strong>搜索和筛选：</strong>支持按各种HTTP字段进行搜索和高级筛选。</li>
                    <li style="margin-bottom: 8px;"><strong>导出功能：</strong>可将应用层请求列表导出为XLSX格式。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.5 数据包详情</h4>
                <p>当您从数据包列表中选择一个数据包后，该页面会显示该数据包的完整详细信息：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>基本信息：</strong>显示数据包的序号、时间戳、长度等基本属性。</li>
                    <li style="margin-bottom: 8px;"><strong>协议解析：</strong>按协议层级展示数据包的结构，从以太网帧到IP层、传输层，再到应用层。</li>
                    <li style="margin-bottom: 8px;"><strong>十六进制视图：</strong>显示数据包的原始十六进制数据，方便深入分析数据包结构。</li>
                    <li style="margin-bottom: 8px;"><strong>关键字匹配：</strong>高亮显示数据包中匹配的关键字。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.6 IP端口统计</h4>
                <p>统计捕获文件中所有IP地址和端口的使用情况：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>IP地址统计：</strong>显示所有源IP和目标IP的出现频率。</li>
                    <li style="margin-bottom: 8px;"><strong>端口统计：</strong>显示所有源端口和目标端口的使用频率。</li>
                    <li style="margin-bottom: 8px;"><strong>连接统计：</strong>显示IP+端口组合的连接情况。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.7 连接频率统计</h4>
                <p>分析网络连接的时间分布和频率：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>时间序列分析：</strong>显示连接请求随时间的变化趋势。</li>
                    <li style="margin-bottom: 8px;"><strong>频率分布：</strong>统计不同时间间隔内的连接数量。</li>
                    <li style="margin-bottom: 8px;"><strong>异常检测：</strong>帮助识别异常的连接模式，如突发大量连接请求。</li>
                </ul>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">3.8 设置</h4>
                <p>用于配置软件的各项功能参数：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;"><strong>关键字管理：</strong>添加、删除和管理用于检测敏感信息的关键字列表。</li>
                    <li style="margin-bottom: 8px;"><strong>匹配开关：</strong>可开启或关闭关键字匹配功能。</li>
                    <li style="margin-bottom: 8px;"><strong>还原默认：</strong>可将关键字列表恢复为默认设置。</li>
                    <li style="margin-bottom: 8px;"><strong>保存设置：</strong>保存当前的关键字配置，以便下次使用。</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">4. 高级功能</h3>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">4.1 多条件高级筛选</h4>
                <p>在数据包列表、流列表和应用层请求标签页中，您可以使用高级筛选功能进行复杂的条件组合筛选：</p>
                <ol style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;">点击"高级筛选"区域的"添加条件"按钮，添加一个筛选条件。</li>
                    <li style="margin-bottom: 8px;">选择要筛选的字段（如源IP、目标端口、协议等）。</li>
                    <li style="margin-bottom: 8px;">选择筛选操作符（如包含、等于、大于、小于等）。</li>
                    <li style="margin-bottom: 8px;">输入筛选值。</li>
                    <li style="margin-bottom: 8px;">选择逻辑关系（AND/OR）。</li>
                    <li style="margin-bottom: 8px;">重复上述步骤，添加更多筛选条件。</li>
                    <li style="margin-bottom: 8px;">点击"应用筛选"按钮，查看筛选结果。</li>
                    <li style="margin-bottom: 8px;">点击"清除筛选"按钮，重置所有筛选条件。</li>
                </ol>
                
                <h4 style="color: #444; margin-top: 15px; margin-bottom: 10px;">4.2 搜索功能</h4>
                <p>各列表页面均支持强大的搜索功能：</p>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;">在搜索框中输入关键词，可快速查找包含该关键词的记录。</li>
                    <li style="margin-bottom: 8px;">可选择搜索的字段范围，如"全部字段"、"源地址"、"协议"等。</li>
                    <li style="margin-bottom: 8px;">搜索结果会实时显示，无需手动提交。</li>
                    <li style="margin-bottom: 8px;">支持部分匹配和模糊搜索。</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">5. 常见问题解答</h3>
                <dl style="padding-left: 20px;">
                    <dt style="margin-bottom: 5px; font-weight: bold; color: #444;">Q: 为什么文件上传后没有反应？</dt>
                    <dd style="margin-bottom: 10px; margin-left: 20px;">A: 可能是文件过大，解析需要时间。请耐心等待，或尝试使用较小的文件进行测试。</dd>
                    
                    <dt style="margin-bottom: 5px; font-weight: bold; color: #444;">Q: 支持哪些文件格式？</dt>
                    <dd style="margin-bottom: 10px; margin-left: 20px;">A: 目前支持PCAP和PCAPNG两种网络流量捕获格式，这是目前最常用的两种格式。</dd>
                    
                    <dt style="margin-bottom: 5px; font-weight: bold; color: #444;">Q: 为什么有些协议没有被正确识别？</dt>
                    <dd style="margin-bottom: 10px; margin-left: 20px;">A: WebShark目前主要支持常见协议（如TCP、UDP、HTTP、DNS等）的解析，对于一些不常见或自定义协议，可能无法完全识别。</dd>
                    
                    <dt style="margin-bottom: 5px; font-weight: bold; color: #444;">Q: 如何保存分析结果？</dt>
                    <dd style="margin-bottom: 10px; margin-left: 20px;">A: 您可以使用数据包列表和应用层请求列表中的导出功能，将数据导出为XLSX格式保存。</dd>
                    
                    <dt style="margin-bottom: 5px; font-weight: bold; color: #444;">Q: 为什么关键字匹配没有结果？</dt>
                    <dd style="margin-bottom: 10px; margin-left: 20px;">A: 请检查关键字列表是否已添加相应的关键字，并且关键字匹配功能是否已开启。</dd>
                </dl>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">5. 性能优化建议</h3>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;">对于大型捕获文件，建议先使用专业工具（如Wireshark）进行初步筛选，只保留需要分析的数据包，再导入WebShark分析。</li>
                    <li style="margin-bottom: 8px;">使用现代浏览器（如Chrome、Firefox、Edge）可以获得更好的性能体验。</li>
                    <li style="margin-bottom: 8px;">在分析过程中，建议关闭其他占用大量内存和CPU的应用程序。</li>
                    <li style="margin-bottom: 8px;">对于超大型文件，可以尝试增加浏览器的内存限制。</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">6. 注意事项</h3>
                <ul style="padding-left: 20px;">
                    <li style="margin-bottom: 8px;">本工具仅供在授权、合法的实验环境中学习和掌握网络原理使用。</li>
                    <li style="margin-bottom: 8px;">请勿用于非法用途，如未经授权的网络监控或攻击。</li>
                    <li style="margin-bottom: 8px;">对于敏感数据，请确保在安全的环境中使用本工具，并妥善处理分析结果。</li>
                    <li style="margin-bottom: 8px;">本工具基于Web技术开发，受限于浏览器的性能，可能无法处理特别巨大的捕获文件。</li>
                    <li style="margin-bottom: 8px;">建议定期清理浏览器缓存，以确保软件正常运行。</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 20px; margin-bottom: 10px;">7. 技术支持</h3>
                <p>如果您在使用过程中遇到问题，或有任何建议和反馈，欢迎访问作者的CSDN博客：</p>
                <p><a href="https://blog.csdn.net/qq_37400312" target="_blank" style="color: #3498db; text-decoration: none;">https://blog.csdn.net/qq_37400312</a></p>
                <p>您可以在博客中留言，或通过博客提供的联系方式与作者取得联系。</p>
            </div>
        </div>
    </div>

    <!-- 模态框控制脚本 -->
    <script>
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'flex';
            setTimeout(() => {
                modal.style.opacity = '1';
            }, 10);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        // 点击模态框外部关闭
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
    </script>
</body>
</html>