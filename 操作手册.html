<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>【CTF-MISC-流量】WebShark 操作手册</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1><a id="WebShark__0"></a>WebShark 操作手册</h1>
<h2><a id="1__2"></a>1. 项目简介</h2>
<p><img src="https://i-blog.csdnimg.cn/direct/cc64160455e142f49700a3034a4d3fc1.png" alt="在这里插入图片描述"></p>
<p>WebShark 是一款基于 Web 的网络流量分析工具，类似于 Wireshark，但运行在浏览器中。它可以打开 PCAP 和 PCAPNG 格式的流量包文件，提供丰富的流量分析功能，包括概览统计、数据包列表、流分析、应用层请求分析等。</p>
<h3><a id="11__8"></a>1.1 主要功能</h3>
<ul>
<li>支持 PCAP 和 PCAPNG 格式的流量包文件</li>
<li>提供直观的流量概览统计</li>
<li>支持数据包的搜索、筛选和排序</li>
<li>网络流分析与对话展示</li>
<li>应用层请求详情分析</li>
<li>IP 端口使用统计</li>
<li>连接频率统计</li>
<li>关键字匹配功能</li>
<li>安全检测功能</li>
<li>表格列宽拖拽调整</li>
<li>IP 归属地查询</li>
<li>端口描述查询</li>
<li>数据导出功能（Excel 格式）</li>
<li>URL 解码功能</li>
<li>时间格式化功能</li>
<li>多种协议支持（HTTP、TCP、UDP、DNS、TLS 等）</li>
</ul>
<h2><a id="2__27"></a>2. 快速开始</h2>
<h3><a id="21__29"></a>2.1 启动应用</h3>
<p>WebShark 是一个静态 Web 应用，可以通过以下方式启动：</p>
<ol>
<li>
<p><strong>本地 HTTP 服务器</strong>（推荐）：</p>
<pre><code class="prism language-bash"><span class="token comment"># 进入代码目录</span>
<span class="token builtin class-name">cd</span> 代码
<span class="token comment"># 使用 Python 启动 HTTP 服务器</span>
python -m http.server <span class="token number">8000</span>
</code></pre>
<p>然后在浏览器中访问 <code>http://localhost:8000</code></p>
</li>
<li>
<p><strong>直接打开 HTML 文件</strong>：<br>
直接双击 <code>代码/index.html</code> 文件在浏览器中打开</p>
</li>
</ol>
<h3><a id="22__45"></a>2.2 加载流量包</h3>
<ol>
<li>
<p>点击页面顶部的 “选择 PCAP/PCAPNG 文件” 按钮<br>
<img src="https://i-blog.csdnimg.cn/direct/383bc8421b4e4b0c969dfd9a1bc4044b.png" alt="在这里插入图片描述"></p>
</li>
<li>
<p>在文件选择对话框中选择要分析的流量包文件<br>
<img src="https://i-blog.csdnimg.cn/direct/da661b49976f49eca61b64c64734be2b.png" alt="在这里插入图片描述"></p>
</li>
<li>
<p>等待文件加载和分析完成<br>
<img src="https://i-blog.csdnimg.cn/direct/20681e14baca4c28a1b995c38f8b9d81.png" alt="在这里插入图片描述"></p>
</li>
<li>
<p>查看各个标签页的分析结果<br>
<img src="https://i-blog.csdnimg.cn/direct/88907eb74bec4cdebf2c6394c48e4320.png" alt="在这里插入图片描述"></p>
</li>
</ol>
<h2><a id="3__60"></a>3. 功能模块详解</h2>
<h3><a id="31__62"></a>3.1 概览</h3>
<p><img src="https://i-blog.csdnimg.cn/direct/c8d1fc48eeff4b189f4bf47995bb644f.png" alt="在这里插入图片描述"></p>
<p>概览页面显示流量包的基本统计信息，包括：</p>
<ul>
<li><strong>数据包数量</strong>：流量包中包含的数据包总数</li>
<li><strong>文件大小</strong>：流量包文件的大小</li>
<li><strong>捕获时长</strong>：流量捕获的总时长</li>
<li><strong>平均包大小</strong>：所有数据包的平均大小</li>
<li><strong>总流量</strong>：所有数据包的总字节数</li>
<li><strong>发送流量</strong>：发送方向的总字节数</li>
<li><strong>接收流量</strong>：接收方向的总字节数</li>
<li><strong>平均速率</strong>：平均数据传输速率</li>
<li><strong>设备信息</strong>：捕获设备的信息（如果可用）</li>
<li><strong>源地址数量</strong>：不同源 IP 地址的数量</li>
</ul>
<p>此外，概览页面还显示<strong>协议使用统计</strong>，直观展示各种应用层协议的使用情况。</p>
<h3><a id="32__81"></a>3.2 数据包列表</h3>
<p>数据包列表页面显示所有数据包的详细信息，并提供搜索、筛选、排序和列宽调整等功能。<br>
<img src="https://i-blog.csdnimg.cn/direct/94afe184716a4257aaf25fc25ae70911.png" alt="在这里插入图片描述"></p>
<h4><a id="321__86"></a>3.2.1 数据包字段说明</h4>

<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>操作</td>
<td>包含操作按钮，用于查看数据包详情等</td>
</tr>
<tr>
<td>唯一 ID</td>
<td>数据包的唯一标识符，用于区分不同数据包</td>
</tr>
<tr>
<td>序号</td>
<td>数据包在流量包中的序号</td>
</tr>
<tr>
<td>时间</td>
<td>数据包的捕获时间，格式为 YYYY-MM-DD HH:MM:SS.SSS</td>
</tr>
<tr>
<td>源地址</td>
<td>数据包的源 IP 地址</td>
</tr>
<tr>
<td>源端口</td>
<td>数据包的源端口，显示实际端口号</td>
</tr>
<tr>
<td>目的地址</td>
<td>数据包的目的 IP 地址</td>
</tr>
<tr>
<td>目标端口</td>
<td>数据包的目标端口，显示实际端口号</td>
</tr>
<tr>
<td>协议</td>
<td>数据包使用的协议链，如 Ethernet → IPv4 → TCP → HTTP</td>
</tr>
<tr>
<td>流 ID</td>
<td>数据包所属的流 ID，用于标识同一连接的数据包</td>
</tr>
<tr>
<td>长度</td>
<td>数据包的长度，单位为字节</td>
</tr>
<tr>
<td>功能介绍</td>
<td>数据包的功能描述，如 “TCP 握手请求”、“HTTP GET 请求” 等</td>
</tr>
<tr>
<td>信息</td>
<td>数据包的详细信息，如 HTTP 请求的 URL、DNS 查询的域名等</td>
</tr>
<tr>
<td>关键字匹配</td>
<td>数据包是否匹配设定的关键字，显示匹配的关键字列表</td>
</tr>
</tbody>
</table><h4><a id="322__106"></a>3.2.2 搜索与筛选</h4>
<ol>
<li>
<p><strong>简单搜索</strong>：</p>
<ul>
<li>在搜索框中输入关键词</li>
<li>选择要搜索的字段（全部字段、唯一 ID、序号、时间、源地址等）</li>
<li>点击 “搜索” 按钮<br>
<img src="https://i-blog.csdnimg.cn/direct/b0a781aff421456f818c859bb9315925.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>高级筛选</strong>：</p>
<ul>
<li>点击 “高级筛选” 区域</li>
<li>添加筛选条件：选择字段、操作符（包含、等于、开始于、结束于、不包含、不等于、大于、小于）、筛选值和逻辑关系（AND/OR）</li>
<li>可以添加多个筛选条件，构建复杂的筛选规则</li>
<li>点击 “应用筛选” 按钮执行筛选<br>
<img src="https://i-blog.csdnimg.cn/direct/de8d846b385a471ab79689e59e141b40.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>表格列筛选</strong>：</p>
<ul>
<li>点击表头右侧的 “▼” 筛选图标，打开筛选下拉菜单</li>
<li>选择要筛选的值（显示值及其出现次数）</li>
<li>点击 “应用” 按钮执行筛选</li>
<li>点击 “清除” 按钮清除该列的筛选条件<br>
<img src="https://i-blog.csdnimg.cn/direct/6af51f22de3a480e8a1a617132af617e.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/f82b841d3ccf4410bdb9b8e421ee31b1.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/baecc215025844cea46d6ea524639739.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>清除筛选</strong>：</p>
<ul>
<li>点击 “清除筛选” 按钮清除所有筛选条件<br>
<img src="https://i-blog.csdnimg.cn/direct/fa045be3002b448b8f4a1199be334536.png" alt="在这里插入图片描述"></li>
</ul>
</li>
</ol>
<h4><a id="323__140"></a>3.2.3 排序</h4>
<ul>
<li>点击表头可以对对应字段进行排序</li>
<li>再次点击可以切换升序/降序</li>
<li>排序会实时应用到当前显示的数据上</li>
</ul>
<p><img src="https://i-blog.csdnimg.cn/direct/68359ca9280f4e70af8ef4698959a550.png" alt="在这里插入图片描述"></p>
<h4><a id="324__148"></a>3.2.4 表格列宽调整</h4>
<ul>
<li>将鼠标悬停在表头之间的分隔线上，鼠标指针会变为双向箭头</li>
<li>按住鼠标左键拖动分隔线，可以调整列宽</li>
<li>列宽调整会实时应用到表格上<br>
<img src="https://i-blog.csdnimg.cn/direct/db10ffcc9229416097c9d86bfeb5dead.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/01d83781a61343db83d712de18ccd238.png" alt="在这里插入图片描述"></li>
</ul>
<h4><a id="325__158"></a>3.2.5 导出数据</h4>
<ul>
<li>点击 “导出 XLSX” 按钮可以将数据包列表导出为 Excel 文件</li>
<li>导出的数据包含当前显示的所有数据包的详细信息<br>
<img src="https://i-blog.csdnimg.cn/direct/72cf32957f0d41d094ed0821c28f2a08.png" alt="在这里插入图片描述"></li>
</ul>
<p><img src="https://i-blog.csdnimg.cn/direct/ba7a1945e2364e758f9de060a7128971.png" alt="在这里插入图片描述"></p>
<h4><a id="326__168"></a>3.2.6 查看数据包详情</h4>
<ul>
<li>点击数据包行中的操作按钮，可以在 “数据包详情” 标签页查看该数据包的详细信息</li>
<li>数据包详情包括各个协议层的详细信息和十六进制数据<br>
<img src="https://i-blog.csdnimg.cn/direct/202cbcfe210845c89e664eabd2ca31f3.png" alt="在这里插入图片描述"></li>
</ul>
<h3><a id="33__176"></a>3.3 流列表</h3>
<p>流列表页面显示网络流的信息，包括流列表和流对话，帮助用户分析网络连接的完整通信过程。<br>
<img src="https://i-blog.csdnimg.cn/direct/77d63f46d7f944cb956e5c06293423f2.png" alt="在这里插入图片描述"></p>
<h4><a id="331__182"></a>3.3.1 流列表</h4>
<p>流列表显示所有网络流的基本信息，包括：</p>
<ul>
<li><strong>流 ID</strong>：流的唯一标识符，用于区分不同的网络连接</li>
<li><strong>源 IP:端口</strong>：流的源地址和端口，格式为 IP:端口</li>
<li><strong>目标 IP:端口</strong>：流的目标地址和端口，格式为 IP:端口</li>
<li><strong>数据包数量</strong>：流中包含的数据包数量，反映连接的活跃度</li>
<li><strong>长度</strong>：流的总长度，单位为字节，反映数据传输量</li>
<li><strong>协议</strong>：流使用的主要协议，如 TCP、UDP、HTTP 等</li>
<li><strong>协议统计</strong>：流中各协议的使用统计，显示不同协议的分布情况</li>
</ul>
<h4><a id="332__194"></a>3.3.2 流对话</h4>
<ul>
<li>点击流列表中的任意一行，可以在右侧查看该流的对话内容</li>
<li>对话内容以消息气泡的形式展示，区分发送和接收方向
<ul>
<li>发送方向：蓝色气泡，显示从源到目标的数据</li>
<li>接收方向：绿色气泡，显示从目标到源的数据</li>
</ul>
</li>
<li>每个消息气泡包含时间戳、发送/接收标识和数据内容</li>
<li>可以使用 “上一条” 和 “下一条” 按钮切换不同的流，方便浏览多个连接<br>
<img src="https://i-blog.csdnimg.cn/direct/8270735bb94f4015a389ec89652d6eb1.jpeg" alt="在这里插入图片描述"></li>
</ul>
<h4><a id="333__206"></a>3.3.3 流搜索与筛选</h4>
<ol>
<li>
<p><strong>简单搜索</strong>：</p>
<ul>
<li>在搜索框中输入关键词（流 ID、IP、端口、协议等）</li>
<li>选择要搜索的字段（全部字段、流 ID、源 IP、源端口、目标 IP、目标端口、数据包数量、协议、流对话）</li>
<li>点击 “搜索” 按钮执行搜索<br>
<img src="https://i-blog.csdnimg.cn/direct/4c0c0e37da2c495da4429d311d3a6514.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>高级筛选</strong>：</p>
<ul>
<li>点击 “高级筛选” 区域</li>
<li>添加筛选条件：选择字段、操作符（包含、等于、开始于、结束于、不包含、不等于、大于、小于）、筛选值和逻辑关系（AND/OR）</li>
<li>可以添加多个筛选条件，构建复杂的筛选规则</li>
<li>点击 “应用筛选” 按钮执行筛选<br>
<img src="https://i-blog.csdnimg.cn/direct/de1b63149088443aa4ecde828acc6df1.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>表格列筛选</strong>：</p>
<ul>
<li>点击流列表表头右侧的 “▼” 筛选图标，打开筛选下拉菜单</li>
<li>选择要筛选的值（显示值及其出现次数）</li>
<li>点击 “应用” 按钮执行筛选<br>
<img src="https://i-blog.csdnimg.cn/direct/7e1f42cb0c944466902a370257177a16.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/05fba462c6c2416982404eba71dc401f.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/86642cc8e3664206ae95e13359fee289.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>清除筛选</strong>：</p>
<ul>
<li>点击 “清除筛选” 按钮清除所有筛选条件<br>
<img src="https://i-blog.csdnimg.cn/direct/fe09706225d34fdcb73141e4252392bc.png" alt="在这里插入图片描述"></li>
</ul>
</li>
</ol>
<h4><a id="334__236"></a>3.3.4 流排序</h4>
<ul>
<li>点击流列表表头可以对对应字段进行排序</li>
<li>可排序的字段包括：流 ID、源 IP:端口、目标 IP:端口、数据包数量、长度、协议</li>
<li>再次点击可以切换升序/降序<br>
<img src="https://i-blog.csdnimg.cn/direct/c386efb178a8434f9fc70c1b5aaebd28.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/b14792d2301a4ae9a81fb99b556eecd5.png" alt="在这里插入图片描述"></li>
</ul>
<h4><a id="335__245"></a>3.3.5 流协议识别</h4>
<ul>
<li>系统会自动识别流中使用的主要协议</li>
<li>对于包含多种协议的流，会显示出现次数最多的协议</li>
<li>协议统计功能会显示流中各协议的分布情况<br>
<img src="https://i-blog.csdnimg.cn/direct/479338f24bee4c38b7a97f7c25853041.png" alt="在这里插入图片描述"></li>
</ul>
<h3><a id="34__252"></a>3.4 应用层请求</h3>
<p>应用层请求页面显示 HTTP 等应用层协议的请求信息，帮助用户分析应用层通信细节。<br>
<img src="https://i-blog.csdnimg.cn/direct/222a5a73efcd48009719f75c995a4802.png" alt="在这里插入图片描述"></p>
<p><img src="https://i-blog.csdnimg.cn/direct/bc0a157aec674d828b8c634a8736d040.png" alt="在这里插入图片描述"></p>
<h4><a id="341__260"></a>3.4.1 请求列表字段</h4>

<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>序号</td>
<td>请求的序号</td>
</tr>
<tr>
<td>请求方法</td>
<td>HTTP 请求方法（GET、POST、PUT、DELETE 等）或其他协议名称</td>
</tr>
<tr>
<td>URL 路径</td>
<td>请求的 URL 路径，已自动 URL 解码</td>
</tr>
<tr>
<td>源 IP:端口</td>
<td>请求的源地址和端口</td>
</tr>
<tr>
<td>目标 IP:端口</td>
<td>请求的目标地址和端口</td>
</tr>
<tr>
<td>响应状态</td>
<td>HTTP 响应状态码，如 200 OK、404 Not Found 等</td>
</tr>
<tr>
<td>响应大小</td>
<td>响应的大小，单位为字节</td>
</tr>
<tr>
<td>Host</td>
<td>请求的 Host 头部，显示请求的域名</td>
</tr>
<tr>
<td>User-Agent</td>
<td>请求的 User-Agent 头部，显示客户端信息</td>
</tr>
<tr>
<td>Accept</td>
<td>请求的 Accept 头部，显示客户端可接受的内容类型</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>请求的 Accept-Language 头部，显示客户端语言偏好</td>
</tr>
<tr>
<td>Cookie</td>
<td>请求的 Cookie 头部，显示客户端发送的 Cookie 信息</td>
</tr>
<tr>
<td>Content-Type</td>
<td>请求的 Content-Type 头部，显示请求体的内容类型</td>
</tr>
<tr>
<td>响应内容类型</td>
<td>响应的 Content-Type 头部，显示响应体的内容类型</td>
</tr>
<tr>
<td>服务器</td>
<td>响应的 Server 头部，显示服务器信息</td>
</tr>
<tr>
<td>响应时间</td>
<td>请求的响应时间，显示从请求到响应的延迟</td>
</tr>
<tr>
<td>请求体内容</td>
<td>请求的正文内容，只显示前 50 个字符</td>
</tr>
<tr>
<td>响应体内容</td>
<td>响应的正文内容，只显示前 50 个字符</td>
</tr>
<tr>
<td>安全状态</td>
<td>请求的安全检测结果，显示 “安全” 或 “危险”</td>
</tr>
<tr>
<td>操作</td>
<td>包含操作按钮，用于查看请求详情等</td>
</tr>
</tbody>
</table><h4><a id="342__285"></a>3.4.2 搜索与筛选</h4>
<ol>
<li>
<p><strong>简单搜索</strong>：</p>
<ul>
<li>在搜索框中输入关键词</li>
<li>选择要搜索的字段（全部字段、请求方法、URL 路径、协议版本、源 IP:端口、目标 IP:端口、响应状态、响应大小等）</li>
<li>点击 “搜索” 按钮执行搜索<br>
<img src="https://i-blog.csdnimg.cn/direct/f3ab57bd1da94d1fb3dd91fb9995c8f0.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>高级筛选</strong>：</p>
<ul>
<li>点击 “高级筛选” 区域</li>
<li>添加筛选条件：选择字段、操作符（包含、等于、开始于、结束于、不包含、不等于、大于、小于）、筛选值和逻辑关系（AND/OR）</li>
<li>可以添加多个筛选条件，构建复杂的筛选规则</li>
<li>点击 “应用筛选” 按钮执行筛选</li>
</ul>
</li>
</ol>
<p><img src="https://i-blog.csdnimg.cn/direct/902c18e4eb2546008104235f921e0a40.png" alt="在这里插入图片描述"></p>
<ol start="3">
<li>
<p><strong>表格列筛选</strong>：</p>
<ul>
<li>点击应用层请求列表表头右侧的 “▼” 筛选图标，打开筛选下拉菜单</li>
<li>选择要筛选的值（显示值及其出现次数）</li>
<li>点击 “应用” 按钮执行筛选<br>
<img src="https://i-blog.csdnimg.cn/direct/59cd1dcc4d4644f1a3e2ecdcb0e42dac.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/c5ce792f7f4e4e86a38626d884ee1124.png" alt="在这里插入图片描述"></li>
</ul>
</li>
<li>
<p><strong>清除筛选</strong>：</p>
<ul>
<li>点击 “清除筛选” 按钮清除所有筛选条件<br>
<img src="https://i-blog.csdnimg.cn/direct/c79ab16311d041829fc190741cea850d.png" alt="在这里插入图片描述"></li>
</ul>
</li>
</ol>
<h4><a id="343__319"></a>3.4.3 排序</h4>
<ul>
<li>点击表头可以对对应字段进行排序</li>
<li>可排序的字段包括：序号、请求方法、URL 路径、源 IP:端口、目标 IP:端口、响应状态、响应大小等</li>
<li>再次点击可以切换升序/降序<br>
<img src="https://i-blog.csdnimg.cn/direct/d27fc684d00546038f85f98fbff94c3f.png" alt="在这里插入图片描述"></li>
</ul>
<h4><a id="344__327"></a>3.4.4 安全检测</h4>
<ul>
<li>系统会自动对每个应用层请求进行安全检测</li>
<li>安全状态字段显示检测结果：
<ul>
<li>“安全”：请求未检测到安全风险</li>
<li>“危险”：请求检测到安全风险，如 XSS 攻击、SQL 注入等</li>
</ul>
</li>
<li>安全检测基于多种规则，包括关键字匹配、请求特征分析等<br>
<img src="https://i-blog.csdnimg.cn/direct/23147e7a5d7e4743aba5d08708c546ea.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/08e6b20f2fa947e7bda6b62eb87fdd53.png" alt="在这里插入图片描述"></li>
</ul>
<h4><a id="345_URL__338"></a>3.4.5 URL 解码</h4>
<ul>
<li>系统会自动对 URL 路径进行 URL 解码，方便查看真实路径</li>
<li>解码后的 URL 路径显示在 “URL 路径” 列中</li>
</ul>
<h4><a id="346__344"></a>3.4.6 导出数据</h4>
<ul>
<li>点击 “导出 XLSX” 按钮可以将应用层请求列表导出为 Excel 文件</li>
<li>导出的数据包含当前显示的所有请求的详细信息</li>
</ul>
<p><img src="https://i-blog.csdnimg.cn/direct/5c80c6e213484bc1bd64d8f43526c798.png" alt="在这里插入图片描述"></p>
<p><img src="https://i-blog.csdnimg.cn/direct/db668c356dbd498888b2b8567f09d7e9.png" alt="在这里插入图片描述"></p>
<h3><a id="35__355"></a>3.5 数据包详情</h3>
<p>数据包详情页面显示单个数据包的详细信息，包括各协议层的解析结果和十六进制数据。<br>
<img src="https://i-blog.csdnimg.cn/direct/2fa842bd2ce24b80b9fc622f18a321a2.jpeg" alt="在这里插入图片描述"></p>
<h4><a id="351__359"></a>3.5.1 查看数据包详情</h4>
<ol>
<li>在数据包列表中点击任意数据包的行</li>
<li>切换到 “数据包详情” 标签页</li>
<li>查看数据包的详细信息<br>
<img src="https://i-blog.csdnimg.cn/direct/a55fd024508949749267e476006b91a3.png" alt="在这里插入图片描述"></li>
</ol>
<h4><a id="352__366"></a>3.5.2 详情内容</h4>
<ul>
<li><strong>协议层信息</strong>：按协议层级显示数据包的详细信息，包括：
<ul>
<li>数据链路层：Ethernet 帧信息</li>
<li>网络层：IP 头部信息（源 IP、目标 IP、TTL 等）</li>
<li>传输层：TCP/UDP 头部信息（源端口、目标端口、序列号等）</li>
<li>应用层：HTTP、DNS 等应用层协议的详细信息</li>
</ul>
</li>
<li><strong>十六进制数据</strong>：显示数据包的原始十六进制数据，方便高级分析</li>
<li><strong>协议字段</strong>：显示各协议层的具体字段及其值</li>
<li><strong>关系图</strong>：显示数据包在流中的位置关系（如果适用）</li>
</ul>
<h4><a id="353__377"></a>3.5.3 详情特点</h4>
<ul>
<li>层次清晰：按协议层级组织信息，方便理解数据包结构</li>
<li>详细全面：包含从物理层到应用层的所有协议信息</li>
<li>直观易懂：使用表格和结构化格式显示信息</li>
<li>原始数据：提供十六进制原始数据，支持深度分析</li>
</ul>
<h3><a id="36_IP__384"></a>3.6 IP 端口统计</h3>
<p>IP 端口统计页面显示 IP 地址和端口的使用情况统计，帮助用户了解网络流量的来源和去向。<br>
<img src="https://i-blog.csdnimg.cn/direct/063d2552458249d2b7b094ebe5515865.png" alt="在这里插入图片描述"></p>
<h4><a id="361__389"></a>3.6.1 统计内容</h4>

<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>IP 地址</td>
<td>网络流量中的源 IP 和目标 IP 地址</td>
</tr>
<tr>
<td>归属地</td>
<td>识别为内网或者外网</td>
</tr>
<tr>
<td>端口</td>
<td>网络流量中的源端口和目标端口</td>
</tr>
<tr>
<td>端口描述</td>
<td>端口的服务描述（如 80 端口显示 HTTP）</td>
</tr>
<tr>
<td>数据包数量</td>
<td>该 IP+端口组合的数据包数量</td>
</tr>
<tr>
<td>占比</td>
<td>该 IP+端口组合在总流量中的占比</td>
</tr>
</tbody>
</table><h4><a id="362__400"></a>3.6.2 统计特点</h4>
<ul>
<li><strong>自动统计</strong>：系统自动分析流量包，生成 IP 端口使用统计</li>
<li><strong>双向统计</strong>：同时统计源 IP+端口和目标 IP+端口</li>
<li><strong>IP 归属地</strong>：自动查询并显示 IP 地址的地理归属地</li>
<li><strong>端口描述</strong>：自动匹配并显示端口对应的服务描述</li>
<li><strong>占比分析</strong>：显示每个 IP+端口组合在总流量中的占比</li>
</ul>
<h4><a id="363__408"></a>3.6.3 查看方式</h4>
<ol>
<li>加载流量包文件</li>
<li>切换到 “IP 端口统计” 标签页</li>
<li>查看 IP 端口使用统计信息</li>
</ol>
<h4><a id="364__414"></a>3.6.4 筛选和搜索</h4>
<ul>
<li>支持表格列筛选功能</li>
<li>点击表头右侧的 “▼” 筛选图标，选择要筛选的值</li>
<li>可以根据 IP 地址、归属地、端口、端口描述等进行筛选</li>
<li>筛选条件对应的数量为数据包的数量<br>
<img src="https://i-blog.csdnimg.cn/direct/3a56785f35ed4368aa875e0cc8c9f127.png" alt="在这里插入图片描述"></li>
</ul>
<h3><a id="37__422"></a>3.7 连接频率统计</h3>
<p>连接频率统计页面显示 IP+端口组合的连接频率统计，帮助用户识别频繁连接的主机和服务。<br>
<img src="https://i-blog.csdnimg.cn/direct/57cd24303808417cad7e8f389ca07edd.png" alt="在这里插入图片描述"></p>
<h4><a id="371__427"></a>3.7.1 统计内容</h4>
<ul>
<li><strong>IP+端口组合</strong>：显示网络中的 IP+端口组合</li>
<li><strong>连接频率</strong>：该 IP+端口组合的连接次数</li>
<li><strong>连接时间分布</strong>：连接发生的时间分布情况</li>
</ul>
<h4><a id="372__433"></a>3.7.2 统计特点</h4>
<ul>
<li><strong>频率分析</strong>：分析连接的频繁程度</li>
<li><strong>时间分布</strong>：显示连接在时间上的分布</li>
<li><strong>异常检测</strong>：帮助识别异常的连接模式</li>
</ul>
<h4><a id="373__439"></a>3.7.3 查看方式</h4>
<ol>
<li>加载流量包文件</li>
<li>切换到 “连接频率统计” 标签页</li>
<li>查看连接频率统计信息</li>
</ol>
<h3><a id="38__447"></a>3.8 设置</h3>
<p>设置页面用于配置 WebShark 的各项功能，包括关键字管理、功能开关等。<br>
<img src="https://i-blog.csdnimg.cn/direct/127930ec5af34662aadc7737e1e7268e.png" alt="在这里插入图片描述"></p>
<h4><a id="381__452"></a>3.8.1 关键字管理</h4>
<p>关键字管理用于配置数据包关键字匹配功能，帮助用户快速识别包含特定关键字的数据包。</p>
<h5><a id="3811__456"></a>3.8.1.1 默认关键字</h5>
<p>系统内置了以下默认关键字：</p>
<ul>
<li><code>flag</code>、<code>fl</code>、<code>KEY</code> - 用于标识标志信息</li>
<li><code>pass</code>、<code>user</code>、<code>admin</code> - 用于标识认证信息</li>
<li><code>select</code>、<code>alter</code> - 用于标识 SQL 操作</li>
<li><code>ctf</code> - 用于 CTF 比赛场景</li>
<li><code>@eval</code>、<code>xss</code> - 用于标识安全漏洞</li>
<li><code>frpc</code> - 用于标识 FRP 客户端</li>
<li><code>linux</code> - 用于标识 Linux 系统命令</li>
<li><code>login</code>、<code>log</code>、<code>.log</code> - 用于标识日志相关信息</li>
<li><code>whoami</code>、<code>echo</code> - 用于标识命令执行</li>
</ul>
<h5><a id="3812__469"></a>3.8.1.2 关键字匹配功能</h5>
<ol>
<li>
<p><strong>启用/禁用关键字匹配</strong>：</p>
<ul>
<li>使用开关按钮控制关键字匹配功能的开启和关闭</li>
<li>开启后，系统会自动扫描数据包，标记包含匹配关键字的数据包</li>
</ul>
</li>
<li>
<p><strong>添加关键字</strong>：</p>
<ul>
<li>在输入框中输入要添加的关键字</li>
<li>点击 “添加” 按钮将关键字添加到列表中</li>
<li>支持添加多个关键字，每个关键字独立匹配</li>
</ul>
</li>
<li>
<p><strong>管理关键字</strong>：</p>
<ul>
<li>在关键字列表中可以查看已添加的所有关键字</li>
<li>可以删除不需要的关键字（点击关键字旁边的删除按钮）</li>
<li>关键字列表实时更新，反映当前配置</li>
</ul>
</li>
<li>
<p><strong>还原默认关键字</strong>：</p>
<ul>
<li>点击 “还原默认关键字” 按钮</li>
<li>系统会清除当前所有关键字，并恢复为默认关键字列表</li>
</ul>
</li>
<li>
<p><strong>保存设置</strong>：</p>
<ul>
<li>点击 “保存设置” 按钮保存所有关键字配置</li>
<li>保存后，关键字配置会立即应用到数据包分析中</li>
</ul>
</li>
</ol>
<h5><a id="3813__493"></a>3.8.1.3 关键字匹配范围</h5>
<p>关键字匹配会检查数据包的以下属性：</p>
<ul>
<li>基本信息：唯一 ID、IP 地址、端口、协议等</li>
<li>应用层数据：HTTP 请求方法、URL、头部信息、请求体等</li>
<li>功能描述：数据包的功能介绍和信息字段</li>
<li>原始数据：应用层原始数据</li>
</ul>
<h4><a id="382__501"></a>3.8.2 设置保存</h4>
<ul>
<li>所有设置会保存在浏览器的本地存储中</li>
<li>刷新页面后，设置会自动恢复</li>
<li>更换浏览器或清除浏览器数据后，设置会丢失</li>
<li>建议定期备份重要设置</li>
</ul>
<h2><a id="4__508"></a>4. 项目结构</h2>
<pre><code>WebShark/
├── 代码/                     # 主程序代码
│   ├── app.js                # 主应用逻辑
│   ├── chart.min.js          # 图表库
│   ├── index.html            # 主页面
│   ├── node_modules/         # 依赖库
│   ├── package.json          # 项目配置
│   ├── package-lock.json     # 依赖锁定文件
│   ├── pcapng-parser.js      # PCAPNG解析器
│   ├── security-detector.js  # 安全检测模块
│   └── xlsx.full.min.js      # Excel导出库
└── 操作手册.md               # 操作手册
</code></pre>
<h2><a id="5__525"></a>5. 技术栈</h2>
<p>WebShark 采用纯前端技术栈开发，无需后端服务，可直接在浏览器中运行。</p>

<table>
<thead>
<tr>
<th>技术</th>
<th>版本</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTML5</td>
<td>-</td>
<td>页面结构和布局</td>
</tr>
<tr>
<td>CSS3</td>
<td>-</td>
<td>页面样式和交互效果</td>
</tr>
<tr>
<td>JavaScript (ES6+)</td>
<td>-</td>
<td>核心逻辑和交互处理</td>
</tr>
<tr>
<td>PCAPNG 解析库</td>
<td>自定义</td>
<td>解析 PCAP 和 PCAPNG 格式的流量包</td>
</tr>
<tr>
<td>Excel 导出库</td>
<td>xlsx.full.min.js</td>
<td>将数据导出为 Excel 文件</td>
</tr>
<tr>
<td>jsdom</td>
<td>27.3.0</td>
<td>用于 Node.js 环境下的测试和开发</td>
</tr>
</tbody>
</table><h3><a id="51__538"></a>5.1 技术特点</h3>
<ul>
<li><strong>纯前端实现</strong>：所有功能在浏览器中完成，无需后端服务</li>
<li><strong>高效解析</strong>：优化的 PCAPNG 解析算法，支持大文件解析</li>
<li><strong>响应式设计</strong>：适配不同屏幕尺寸</li>
<li><strong>模块化架构</strong>：代码结构清晰，易于维护和扩展</li>
<li><strong>丰富的交互</strong>：表格排序、筛选、列宽调整等交互功能</li>
<li><strong>实时分析</strong>：流量包加载后实时进行分析和统计</li>
</ul>
<h3><a id="52__547"></a>5.2 浏览器兼容性</h3>
<ul>
<li>Chrome 80+：最佳支持</li>
<li>Firefox 75+：良好支持</li>
<li>Safari 13+：基本支持</li>
<li>Edge 80+：良好支持</li>
</ul>
<h2><a id="6__554"></a>6. 项目特点</h2>
<h3><a id="61__556"></a>6.1 易用性</h3>
<ul>
<li><strong>直观的界面</strong>：清晰的标签页布局，易于导航</li>
<li><strong>简单的操作</strong>：拖拽文件即可加载，点击即可查看详情</li>
<li><strong>丰富的提示</strong>：友好的操作提示和状态反馈</li>
</ul>
<h3><a id="62__562"></a>6.2 功能性</h3>
<ul>
<li><strong>全面的分析</strong>：从数据链路层到应用层的完整分析</li>
<li><strong>强大的搜索</strong>：支持多种搜索和筛选方式</li>
<li><strong>实时的统计</strong>：动态生成各种统计图表和数据</li>
<li><strong>安全的检测</strong>：内置安全检测功能，识别潜在威胁</li>
</ul>
<h3><a id="63__569"></a>6.3 扩展性</h3>
<ul>
<li><strong>模块化设计</strong>：易于添加新的协议解析器</li>
<li><strong>可定制的关键字</strong>：支持用户自定义关键字列表</li>
<li><strong>开放的架构</strong>：支持扩展新的功能模块</li>
</ul>
<h3><a id="64__575"></a>6.4 性能</h3>
<ul>
<li><strong>高效的解析</strong>：优化的解析算法，支持大文件</li>
<li><strong>流畅的交互</strong>：优化的渲染和交互性能</li>
<li><strong>低内存占用</strong>：高效的内存管理，支持长时间运行</li>
</ul>
<h2><a id="7__581"></a>7. 使用技巧</h2>
<h3><a id="71__583"></a>7.1 快速定位数据包</h3>
<ol>
<li><strong>使用关键字匹配</strong>：在设置中添加相关关键字，系统会自动标记匹配的数据包</li>
<li><strong>使用搜索功能</strong>：利用搜索框快速查找特定 IP、端口或协议的数据包</li>
<li><strong>使用筛选功能</strong>：通过高级筛选条件精确查找数据包</li>
</ol>
<h3><a id="72__589"></a>7.2 分析网络流</h3>
<ol>
<li>查看流列表，了解网络连接情况</li>
<li>点击流查看完整对话内容</li>
<li>分析流的协议分布和数据传输情况</li>
</ol>
<h3><a id="73__595"></a>7.3 识别安全威胁</h3>
<ol>
<li>查看应用层请求的安全状态字段</li>
<li>关注标记为 “危险” 的请求</li>
<li>分析危险请求的详细信息，确定威胁类型</li>
</ol>
<h3><a id="74__601"></a>7.4 优化大文件处理</h3>
<ol>
<li>对于大型流量包，建议关闭关键字匹配功能</li>
<li>调整每页显示数量，减少内存占用</li>
<li>使用筛选功能，只查看感兴趣的数据</li>
</ol>
<h3><a id="75__607"></a>7.5 导出数据</h3>
<ol>
<li>选择要导出的数据范围（使用筛选功能）</li>
<li>点击相应的导出按钮</li>
<li>保存导出的 Excel 文件，用于进一步分析</li>
</ol>
<h2><a id="8__613"></a>8. 技术细节</h2>
<h3><a id="81__615"></a>8.1 流量包解析</h3>
<ul>
<li><strong>支持格式</strong>：PCAP 和 PCAPNG 格式</li>
<li><strong>解析方式</strong>：基于 FileReader API 和 ArrayBuffer</li>
<li><strong>解析流程</strong>：
<ol>
<li>读取文件内容为 ArrayBuffer</li>
<li>解析文件头和块结构</li>
<li>解析每个数据包</li>
<li>提取协议信息</li>
<li>生成分析结果</li>
</ol>
</li>
</ul>
<h3><a id="82__626"></a>8.2 流重组</h3>
<ul>
<li><strong>流识别</strong>：基于 5 元组（源 IP、源端口、目标 IP、目标端口、协议）</li>
<li><strong>流重组</strong>：将同一流的数据包组合在一起</li>
<li><strong>对话生成</strong>：根据数据包的方向生成对话内容</li>
</ul>
<h3><a id="83__632"></a>8.3 安全检测</h3>
<ul>
<li><strong>检测方式</strong>：基于规则匹配和特征分析</li>
<li><strong>检测范围</strong>：
<ul>
<li>HTTP 请求和响应</li>
<li>应用层数据</li>
<li>关键字匹配</li>
</ul>
</li>
<li><strong>检测规则</strong>：
<ul>
<li>XSS 攻击检测</li>
<li>SQL 注入检测</li>
<li>命令执行检测</li>
<li>敏感信息泄露检测</li>
</ul>
</li>
</ul>
<h3><a id="84__645"></a>8.4 数据存储</h3>
<ul>
<li><strong>本地存储</strong>：使用浏览器的 localStorage 存储设置和配置</li>
<li><strong>临时存储</strong>：使用内存存储解析结果和分析数据</li>
<li><strong>无持久化存储</strong>：刷新页面后，解析结果会丢失，需重新加载文件</li>
</ul>
<h2><a id="9__651"></a>9. 使用示例</h2>
<h3><a id="91__HTTP__653"></a>9.1 分析 HTTP 请求</h3>
<ol>
<li>加载包含 HTTP 流量的 PCAP/PCAPNG 文件</li>
<li>切换到 “应用层请求” 标签页</li>
<li>查看 HTTP 请求列表，包含请求方法、URL 路径、响应状态等信息</li>
<li>使用搜索或筛选功能查找特定请求（如按 URL 路径搜索）</li>
<li>点击请求查看详细信息，包括请求头、响应头和请求体</li>
<li>查看安全状态字段，识别潜在的安全威胁</li>
</ol>
<h3><a id="92__662"></a>9.2 分析网络流</h3>
<ol>
<li>加载流量包文件</li>
<li>切换到 “流列表” 标签页</li>
<li>查看流列表，了解所有网络连接的基本信息</li>
<li>选择感兴趣的流，查看右侧的流对话内容</li>
<li>观察对话的发送和接收方向，分析通信过程</li>
<li>使用 “上一条” 和 “下一条” 按钮浏览不同流</li>
<li>查看流的协议统计，了解流中使用的协议分布</li>
</ol>
<h3><a id="93__672"></a>9.3 查找匹配关键字的数据包</h3>
<ol>
<li>切换到 “设置” 标签页</li>
<li>启用关键字匹配功能（打开开关）</li>
<li>添加感兴趣的关键字（如 “password”、“login”、“flag” 等）</li>
<li>点击 “保存设置” 按钮</li>
<li>切换到 “数据包列表” 标签页</li>
<li>查看 “关键字匹配” 列，找到匹配的数据包</li>
<li>点击匹配的数据包查看详细信息</li>
</ol>
<h3><a id="94__IP__682"></a>9.4 分析 IP 端口使用情况</h3>
<ol>
<li>加载流量包文件</li>
<li>切换到 “IP 端口统计” 标签页</li>
<li>查看 IP 地址和端口的使用统计</li>
<li>查看 IP 地址的归属地信息</li>
<li>查看端口的服务描述</li>
<li>使用筛选功能，根据 IP 地址或端口进行筛选</li>
</ol>
<h3><a id="95__691"></a>9.5 导出分析结果</h3>
<ol>
<li>完成流量包分析</li>
<li>切换到要导出数据的标签页（如数据包列表、应用层请求）</li>
<li>使用筛选功能选择要导出的数据范围</li>
<li>点击 “导出 XLSX” 按钮</li>
<li>在弹出的对话框中选择保存位置和文件名</li>
<li>点击 “保存” 按钮，将数据导出为 Excel 文件</li>
</ol>
<h2><a id="10__700"></a>10. 常见问题</h2>
<h3><a id="101__702"></a>10.1 支持哪些文件格式？</h3>
<ul>
<li>PCAP 格式</li>
<li>PCAPNG 格式</li>
</ul>
<h3><a id="102__707"></a>10.2 为什么文件加载失败？</h3>
<ul>
<li><strong>文件格式错误</strong>：请确保文件格式为 PCAP 或 PCAPNG</li>
<li><strong>文件损坏</strong>：请确保文件没有损坏，尝试使用其他工具验证文件完整性</li>
<li><strong>文件过大</strong>：对于大型文件，可能需要较长时间加载，请耐心等待</li>
<li><strong>浏览器兼容性</strong>：请使用支持的浏览器版本（Chrome 80+、Firefox 75+、Safari 13+、Edge 80+）</li>
</ul>
<h3><a id="103__714"></a>10.3 如何提高大型文件的加载速度？</h3>
<ul>
<li>关闭不必要的功能（如关键字匹配）</li>
<li>优化浏览器性能：关闭其他标签页和扩展程序</li>
<li>使用较新版本的浏览器</li>
<li>考虑将大型文件分割为多个小型文件</li>
</ul>
<h3><a id="104__721"></a>10.4 如何保存分析结果？</h3>
<ul>
<li><strong>导出为 Excel</strong>：使用页面上的 “导出 XLSX” 按钮，将数据导出为 Excel 文件</li>
<li><strong>截图保存</strong>：使用浏览器的截图功能保存当前页面</li>
<li><strong>复制数据</strong>：直接从表格中复制数据到其他应用程序</li>
</ul>
<h3><a id="105__727"></a>10.5 为什么关键字匹配功能不生效？</h3>
<ul>
<li>请确保已启用关键字匹配功能（设置页面中的开关已打开）</li>
<li>请确保已保存设置</li>
<li>请检查关键字列表中是否包含要匹配的关键字</li>
<li>请确保数据包中确实包含要匹配的关键字</li>
</ul>
<h3><a id="106__734"></a>10.6 如何添加自定义关键字？</h3>
<ol>
<li>切换到 “设置” 标签页</li>
<li>在关键字输入框中输入要添加的关键字</li>
<li>点击 “添加” 按钮</li>
<li>点击 “保存设置” 按钮保存更改</li>
</ol>
<h2><a id="11__741"></a>11. 版本更新日志</h2>
<h3><a id="_743"></a>最新版本</h3>
<ul>
<li>支持 PCAP 和 PCAPNG 格式的流量包文件</li>
<li>提供直观的流量概览统计</li>
<li>支持数据包的搜索、筛选和排序</li>
<li>网络流分析与对话展示</li>
<li>应用层请求详情分析</li>
<li>IP 端口使用统计</li>
<li>连接频率统计</li>
<li>关键字匹配功能</li>
<li>安全检测功能</li>
<li>表格列宽拖拽调整</li>
<li>IP 归属地查询</li>
<li>端口描述查询</li>
<li>数据导出功能（Excel 格式）</li>
<li>URL 解码功能</li>
<li>时间格式化功能</li>
<li>多种协议支持</li>
</ul>
<h1><a id="WebShark_763"></a>WebShark案例</h1>
<h1><a id="SQL_765"></a>案例一：分析SQL盲注问题</h1>
<p>攻防世界：https://adworld.xctf.org.cn/challenges/list<br>
流量分析<br>
<img src="https://i-blog.csdnimg.cn/direct/c26f3593c26448e7aef75629369c766b.png" alt="在这里插入图片描述"></p>
<h2><a id="WebShark_772"></a>打开WebShark</h2>
<p><img src="https://i-blog.csdnimg.cn/direct/beebb7e5f46643c8bff0a0ca94c32e29.png" alt="在这里插入图片描述"></p>
<h2><a id="_776"></a>选择流量包文件打开</h2>
<p>概览界面出现了流量包的基本信息</p>
<p><img src="https://i-blog.csdnimg.cn/direct/244c8d2b590b432bae4988f5f1e701ae.png" alt="在这里插入图片描述"></p>
<h2><a id="HTTPURL_781"></a>打开HTTP请求URL模块</h2>
<p>因为题目提示了sql注入，所以我们直接看HTTP请求就可以了<br>
看到HTTP请求的URL路径<br>
<img src="https://i-blog.csdnimg.cn/direct/a8084b7230124b4e9bfea582d38d3365.png" alt="在这里插入图片描述"></p>
<h2><a id="URL_787"></a>拖拉表头查看完整URL路径</h2>
<p>一看就知道是SQL注入，还是盲注，那么看响应体内容<br>
<img src="https://i-blog.csdnimg.cn/direct/2ec18dd843d04c59b797629951d9599b.png" alt="在这里插入图片描述"></p>
<h2><a id="_791"></a>筛选响应体内容</h2>
<p>把不一样的响应体筛选出来，就可以知道哪几次盲注成功了<br>
一般都是数量少的是注入成功的，直接筛选，也可以点击响应详情仔细斟酌<br>
<img src="https://i-blog.csdnimg.cn/direct/5dec791bb79c4a98b3bb6969393c10e8.png" alt="在这里插入图片描述"></p>
<p><img src="https://i-blog.csdnimg.cn/direct/c1957eb1a8d54f8095950f2b2ca252ce.png" alt="在这里插入图片描述"></p>
<h2><a id="url_799"></a>分析其中一个注入成功的url</h2>
<p><img src="https://i-blog.csdnimg.cn/direct/46434705a9c549bca484d9b034fc8eea.png" alt="在这里插入图片描述"></p>
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">and</span> ascii<span class="token punctuation">(</span>substring<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> keyid <span class="token keyword">from</span> flag <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">54</span><span class="token comment">#</span>
</code></pre>
<blockquote>
<p>“测试 flag 表中第一行的 keyid 字段值的第 18 个字符的 ASCII 码是否为 54（即是否为数字 ‘6’）。”</p>
</blockquote>
<h2><a id="HTTPxlsx_809"></a>将筛选的HTTP请求导出为xlsx格式</h2>
<p><img src="https://i-blog.csdnimg.cn/direct/39c87562e25e4e0397e5019419648227.png" alt="在这里插入图片描述"></p>
<h2><a id="WPSexcel_812"></a>用WPS的excel的高级分列，将盲注的信息分割出来</h2>
<p>其他工具也可以，或者自己写个python代码分割也行，本人用WPS因为方便<br>
<img src="https://i-blog.csdnimg.cn/direct/bfada8640db840c0ba10bab47805019a.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/76f3adfe9363412da17d34ac220292ce.png" alt="在这里插入图片描述"></p>
<p><img src="https://i-blog.csdnimg.cn/direct/4d93645f55154db48abdd07dbba42e2b.png" alt="在这里插入图片描述"><br>
使用=CHAR(E2)将ascii数值转换为字符串</p>
<p><img src="https://i-blog.csdnimg.cn/direct/0fa6c995d443400dad8a364e1627c012.png" alt="在这里插入图片描述"><br>
再去word里面全部替换一下获取结果<br>
<img src="https://i-blog.csdnimg.cn/direct/9035170b0eec42e1ae93087b322b9a79.png" alt="在这里插入图片描述"><br>
<img src="https://i-blog.csdnimg.cn/direct/ee3e29dd7bbf42c59c287691d5675416.png" alt="在这里插入图片描述"></p>
<h2><a id="_824"></a>得到最终答案</h2>
<p>flag{c2bbf9cecdaf656cf524d014c5bf046c}</p>
<h1><a id="SMTP_842"></a>案例二：SMTP协议邮件分析</h1>
<p>第二届全国网络安全行业职业技能大赛-电子数据取证分析师-初赛<br>
其中15-19题和流量分析有关：<br>
15.（检材3分析）收件人邮箱是什么？<br>
16.（检材3分析）发件人使用的客户端软件以及版本是什么？（参考格式：abc 1.1.11.111[ab]）<br>
17. （检材3分析）邮件的主题是什么？<br>
18. （检材3分析）已知邮箱附件采用7位数字加密，请问该7位数字密码是什么？<br>
19. （检材3分析）已知邮箱附件中有一个lvm文件，请填写里面的URL信息。（参考格式：http://a.com/）</p>
<p><img src="https://i-blog.csdnimg.cn/direct/11c3c1dadcc74b8abea86563f849facb.png" alt="在这里插入图片描述"></p>
<h2><a id="15_854"></a>15题：收件人邮箱是什么？</h2>
<h3><a id="WebShark_855"></a>打开WebShark</h3>
<p><img src="https://i-blog.csdnimg.cn/direct/438935cbc77545e0a14f27583a88312f.png" alt="在这里插入图片描述"></p>
<h3><a id="_858"></a>选择要分析的流量包</h3>
<p><img src="https://i-blog.csdnimg.cn/direct/d8ac76ad401341db820e31f9ef6af66a.png" alt="在这里插入图片描述"></p>
<h3><a id="SMTP_862"></a>进入数据包列表，搜索SMTP协议</h3>
<p><img src="https://i-blog.csdnimg.cn/direct/f39067d306dd484690432b3a2030ad35.png" alt="在这里插入图片描述"></p>
<h3><a id="SMTP_867"></a>查看SMTP协议的信息内容</h3>
<p>发现RCPT TO: <a href="mailto:rihanaliyboy@163.com">rihanaliyboy@163.com</a>，表示邮箱发送至rihanaliyboy@163.com邮箱<br>
所以，第15题答案为：rihanaliyboy@163.com<br>
<img src="https://i-blog.csdnimg.cn/direct/099b041767274cfcbafab2a149eb7410.png" alt="在这里插入图片描述"></p>
<h2><a id="16_873"></a>第16题：发件人使用的客户端软件以及版本是什么？</h2>
<h3><a id="_874"></a>查看流对话</h3>
<p>查看15题找到收件人信息的数据包，点击流对话</p>
<p><img src="https://i-blog.csdnimg.cn/direct/e8b5519026fa4461b3eef31d380d4c06.png" alt="在这里插入图片描述"></p>
<h3><a id="_878"></a>可以看到邮件客户端版本信息</h3>
<p>答案：Foxmail 7.2.23.121[cn]<br>
<img src="https://i-blog.csdnimg.cn/direct/132f707726044b38a126bea2abbf28c1.png" alt="在这里插入图片描述"></p>
<h2><a id="17_882"></a>第17题：邮件的主题是什么？</h2>
<h3><a id="16_884"></a>从第16题的结果中可以看到主题</h3>
<p>答案:info</p>
<h2><a id="1877_887"></a>第18题：已知邮箱附件采用7位数字加密，请问该7位数字密码是什么？</h2>
<h3><a id="_888"></a>将流对话中的附件信息提取出来</h3>
<p><img src="https://i-blog.csdnimg.cn/direct/8cb214c94dfe4a87856c59d736624fd4.png" alt="在这里插入图片描述"></p>
<h3><a id="base64_891"></a>进行base64解密，并下载为文件</h3>
<p>Base64解密工具：https://mate.tools/zh/base64-decoder</p>
<p><img src="https://i-blog.csdnimg.cn/direct/00eb7f5361ec46afae30749bcf366b9b.png" alt="在这里插入图片描述"></p>
<h3><a id="_895"></a>下载发现有密码</h3>
<p><img src="https://i-blog.csdnimg.cn/direct/a68d5a7ce1be49328d77891fcc8adb0b.png" alt="在这里插入图片描述"></p>
<h3><a id="Passware_Kit_Forensic_898"></a>使用破解工具破解密码Passware Kit Forensic</h3>
<p>找到答案：7894123<br>
<img src="https://i-blog.csdnimg.cn/direct/062e38c5485546668ba7d02bd149b4d6.png" alt="在这里插入图片描述"></p>
<p><img src="https://i-blog.csdnimg.cn/direct/33edec4eef7940a7b7268f1b427fc289.png" alt="在这里插入图片描述"></p>
<h2><a id="19lvmURL_903"></a>第19题：已知邮箱附件中有一个lvm文件，请填写里面的URL信息。</h2>
<h3><a id="informationlvm_904"></a>用记事本打开上一道题的information.lvm文件</h3>
<p>答案:http://lovema.world3.com/</p>
<p><img src="https://i-blog.csdnimg.cn/direct/b7f37d19b4174200aa2fcc2dbf3d7a5c.png" alt="在这里插入图片描述"></p>
</div>
</body>

</html>
